# dag-sync-sidecar.yaml
# We use the official Kubernetes git-sync sidecar to pull DAGs from
# a remote repository.

# --- git-sync container spec fragment ---
# This is used as a sidecar in webserver and scheduler deployments.
# It syncs https://github.com/UtkarshChakrwarti/remote_airflow.git
# to a shared volume.

# Note: We no longer need the local dags-local-pv/pvc here as we 
# will use a shared emptyDir for the synced git repo, or continue 
# using the PVC if we want persistence across pod restarts.
# Let's use the PVC for the synced content to avoid re-cloning on every restart.

apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: git-sync-pvc
  namespace: airflow
spec:
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: 1Gi
  storageClassName: "" # Use default (standard) or leave empty for Kind
