# dag-sync-sidecar.yaml
# We use the official Kubernetes git-sync sidecar to pull DAGs from
# a remote repository.

# --- git-sync container spec fragment ---
# This is used as a sidecar in webserver and scheduler deployments.
# It syncs https://github.com/UtkarshChakrwarti/remote_airflow.git
# to a shared volume.

# Transitioned to production-grade dynamic provisioning.
# We no longer use hostPath for dags.

apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: git-sync-pvc
  namespace: airflow
  labels:
    app: airflow
    part-of: gitops-poc
spec:
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: 1Gi
  storageClassName: "standard" # Use dynamic provisioning
